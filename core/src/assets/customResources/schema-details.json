{
  "$schema": "http://json-schema.org/draft-07/schema",
  "description": "Schema defining structure of details configuration",
  "required": [
    "header",
    "body"
  ],
  "title": "Custom pages to be displayed in Busola",
  "type": "object",
  "properties": {
    "header": {
      "description": "Configuration of fields/data that should be displayed in header section of resource details page.",
      "type": "array",
      "items": {
        "$ref": "#/$defs/component"
      }
    },
    "body": {
      "description": "Configuration of fields/data that should be displayed in body section of resource details page.",
      "type": "array",
      "items": {
        "$ref": "#/$defs/component"
      }
    }
  },
  "$defs": {
    "children": {
      "properties": {
        "children": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/component"
          }
        }
      }
    },
    "Panel": {
      "if": {
        "properties": {
          "widget": { "const": "Panel" }
        }
      },
      "then": {
        "$ref": "#/$defs/children"
      }
    },
    "Table": {
      "if": {
        "properties": {
          "widget": { "const": "Table" }
        }
      },
      "then": {
        "allOff": [
          {
            "properties": {
              "children": {
                "type": "array",
                "items": {
                  "$ref": "#/$defs/component"
                }
              }
            }
          },
          {
            "$ref": "#/$defs/children"
          }
        ]
      }
    },
    "component": {
      "type": "object",
      "properties": {
        "name": {
          "description": "Name of component used for dispaying translations",
          "type": "string"
        },
        "source": {
          "description": "Jsonata script used to fetch the data",
          "examples": [
            "status.phase",
            "metadata.labels"
          ],
          "type": "string"
        },
        "widget": {
          "description": "Name of a widget that should be used for displaying data defined by path",
          "examples": [
            "Badge",
            "CodeViewer"
          ],
          "type": "string",
          "enum": [
            "Badge",
            "Text",
            "Plain",
            "Panel",
            "Columns",
            "CodeViewer",
            "Table",
            "ResourceRefs",
            "ControlledBy",
            "JoinedArray",
            "ResourceList",
            "ResourceLink",
            "Labels",
            "Alert",
            "ExternalLink",
            "Tabs",
            "EventList"
          ]
        }
      },
      "allOf": [
        { "$ref": "#/$defs/Panel" },
        { "$ref": "#/$defs/Table" },
        {
          "if": {
            "properties": {
              "widget": { "enum": ["", "Panel", "Columns", "JoinedArray", "Plain"] }
            }
          },
          "then": {
            "properties": {
              "children": {
                "type": "array",
                "items": {
                  "$ref": "#/$defs/component"
                }
              }
            }
          }
        }
      ]
    },
    "list": {
      "anyOf": [
        {
          "type": "array",
          "items": {
            "$ref": "#/$defs/component"
          }
        },
        {
          "$ref": "#/$defs/component"
        }
      ]
    }
  }
}
